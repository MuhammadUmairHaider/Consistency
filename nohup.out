python: can't open file '/mounts/u-amo-d1/grad/mha361/work/probless/Sentiment/main_llama_copy.py': [Errno 2] No such file or directory
Traceback (most recent call last):
  File "/mounts/u-amo-d1/grad/mha361/work/probless/Sentiment/main_llma_copy.py", line 13, in <module>
    from datasets import load_dataset
ModuleNotFoundError: No module named 'datasets'
Loading custom correct‑predictions dataset …
Total examples: 26186

Class Distribution
----------------------------------------
6: 2000  (7.64%)
2: 2000  (7.64%)
9: 2000  (7.64%)
1: 2000  (7.64%)
13: 2000  (7.64%)
7: 2000  (7.64%)
8: 1730  (6.61%)
11: 2000  (7.64%)
0: 2000  (7.64%)
4: 2000  (7.64%)
3: 2000  (7.64%)
12: 2000  (7.64%)
10: 2000  (7.64%)
5: 456  (1.74%)
Auxiliary datasets loaded (Wiki + SQuAD).
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  1.19it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.52it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.46it/s]
/mounts/u-amo-d1/grad/mha361/work/probless/Sentiment/main_llma_copy.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(weights_path))
Model weights loaded.
Evaluating LM:   0%|          | 0/2000 [00:00<?, ?it/s]Perplexity: 8.7117:   0%|          | 0/2000 [00:00<?, ?it/s]Perplexity: 8.7117:   0%|          | 1/2000 [00:00<13:06,  2.54it/s]Perplexity: 7.4429:   0%|          | 1/2000 [00:00<13:06,  2.54it/s]Perplexity: 7.4429:   0%|          | 2/2000 [00:00<09:29,  3.51it/s]Perplexity: 7.1916:   0%|          | 2/2000 [00:00<09:29,  3.51it/s]Perplexity: 7.1916:   0%|          | 3/2000 [00:00<08:14,  4.04it/s]Perplexity: 6.8636:   0%|          | 3/2000 [00:01<08:14,  4.04it/s]Perplexity: 6.8636:   0%|          | 4/2000 [00:01<07:36,  4.37it/s]Perplexity: 6.1817:   0%|          | 4/2000 [00:01<07:36,  4.37it/s]Perplexity: 6.1817:   0%|          | 5/2000 [00:01<07:32,  4.41it/s]Perplexity: 6.3674:   0%|          | 5/2000 [00:01<07:32,  4.41it/s]Perplexity: 6.3674:   0%|          | 6/2000 [00:01<07:23,  4.50it/s]Perplexity: 6.1274:   0%|          | 6/2000 [00:01<07:23,  4.50it/s]Perplexity: 6.1274:   0%|          | 7/2000 [00:01<07:24,  4.48it/s]Perplexity: 5.3090:   0%|          | 7/2000 [00:01<07:24,  4.48it/s]Perplexity: 5.3090:   0%|          | 8/2000 [00:01<07:22,  4.51it/s]Perplexity: 5.5494:   0%|          | 8/2000 [00:02<07:22,  4.51it/s]Perplexity: 5.5494:   0%|          | 9/2000 [00:02<07:06,  4.66it/s]Perplexity: 5.4858:   0%|          | 9/2000 [00:02<07:06,  4.66it/s]Perplexity: 5.4858:   0%|          | 10/2000 [00:02<05:58,  5.55it/s]Perplexity: 5.2419:   0%|          | 10/2000 [00:02<05:58,  5.55it/s]Perplexity: 5.2419:   1%|          | 11/2000 [00:02<06:17,  5.27it/s]Perplexity: 5.5639:   1%|          | 11/2000 [00:02<06:17,  5.27it/s]Perplexity: 5.5639:   1%|          | 12/2000 [00:02<06:21,  5.22it/s]Perplexity: 5.6698:   1%|          | 12/2000 [00:02<06:21,  5.22it/s]Perplexity: 5.6698:   1%|          | 13/2000 [00:02<06:27,  5.13it/s]Perplexity: 5.9061:   1%|          | 13/2000 [00:02<06:27,  5.13it/s]Perplexity: 5.9061:   1%|          | 14/2000 [00:02<06:28,  5.11it/s]Perplexity: 6.0763:   1%|          | 14/2000 [00:03<06:28,  5.11it/s]Perplexity: 6.0763:   1%|          | 15/2000 [00:03<06:37,  4.99it/s]Perplexity: 6.0505:   1%|          | 15/2000 [00:03<06:37,  4.99it/s]Perplexity: 6.0505:   1%|          | 16/2000 [00:03<06:43,  4.92it/s]Perplexity: 5.9242:   1%|          | 16/2000 [00:03<06:43,  4.92it/s]Perplexity: 5.9242:   1%|          | 17/2000 [00:03<06:38,  4.98it/s]Perplexity: 6.0663:   1%|          | 17/2000 [00:03<06:38,  4.98it/s]Perplexity: 6.0663:   1%|          | 18/2000 [00:03<06:36,  5.01it/s]Perplexity: 5.8642:   1%|          | 18/2000 [00:04<06:36,  5.01it/s]Perplexity: 5.8642:   1%|          | 19/2000 [00:04<06:49,  4.84it/s]Perplexity: 5.9781:   1%|          | 19/2000 [00:04<06:49,  4.84it/s]Perplexity: 5.9781:   1%|          | 20/2000 [00:04<06:49,  4.84it/s]Perplexity: 6.0587:   1%|          | 20/2000 [00:04<06:49,  4.84it/s]Perplexity: 6.0587:   1%|          | 21/2000 [00:04<06:53,  4.79it/s]Perplexity: 6.1047:   1%|          | 21/2000 [00:04<06:53,  4.79it/s]Perplexity: 6.1047:   1%|          | 22/2000 [00:04<06:46,  4.86it/s]Perplexity: 6.1521:   1%|          | 22/2000 [00:04<06:46,  4.86it/s]Perplexity: 6.1521:   1%|          | 23/2000 [00:04<06:52,  4.80it/s]Perplexity: 6.0843:   1%|          | 23/2000 [00:05<06:52,  4.80it/s]Perplexity: 6.0843:   1%|          | 24/2000 [00:05<06:44,  4.88it/s]Perplexity: 6.0734:   1%|          | 24/2000 [00:05<06:44,  4.88it/s]Perplexity: 6.0734:   1%|▏         | 25/2000 [00:05<06:40,  4.94it/s]Perplexity: 6.0790:   1%|▏         | 25/2000 [00:05<06:40,  4.94it/s]Perplexity: 6.0790:   1%|▏         | 26/2000 [00:05<06:42,  4.91it/s]Perplexity: 6.0590:   1%|▏         | 26/2000 [00:05<06:42,  4.91it/s]Perplexity: 6.0590:   1%|▏         | 27/2000 [00:05<06:25,  5.12it/s]Perplexity: 6.0927:   1%|▏         | 27/2000 [00:05<06:25,  5.12it/s]Perplexity: 6.0927:   1%|▏         | 28/2000 [00:05<06:33,  5.01it/s]Perplexity: 6.1496:   1%|▏         | 28/2000 [00:06<06:33,  5.01it/s]Perplexity: 6.1496:   1%|▏         | 29/2000 [00:06<07:01,  4.68it/s]Perplexity: 6.0681:   1%|▏         | 29/2000 [00:06<07:01,  4.68it/s]Perplexity: 6.0681:   2%|▏         | 30/2000 [00:06<07:03,  4.65it/s]Perplexity: 6.1241:   2%|▏         | 30/2000 [00:06<07:03,  4.65it/s]Perplexity: 6.1241:   2%|▏         | 31/2000 [00:06<06:57,  4.71it/s]Perplexity: 6.1031:   2%|▏         | 31/2000 [00:06<06:57,  4.71it/s]Perplexity: 6.1031:   2%|▏         | 32/2000 [00:06<06:55,  4.73it/s]Perplexity: 6.0093:   2%|▏         | 32/2000 [00:06<06:55,  4.73it/s]Perplexity: 6.0093:   2%|▏         | 33/2000 [00:06<06:59,  4.69it/s]Perplexity: 5.8664:   2%|▏         | 33/2000 [00:07<06:59,  4.69it/s]Perplexity: 5.8664:   2%|▏         | 34/2000 [00:07<06:51,  4.77it/s]Perplexity: 5.8434:   2%|▏         | 34/2000 [00:07<06:51,  4.77it/s]Perplexity: 5.8434:   2%|▏         | 35/2000 [00:07<06:45,  4.85it/s]Perplexity: 5.7904:   2%|▏         | 35/2000 [00:07<06:45,  4.85it/s]Perplexity: 5.7904:   2%|▏         | 36/2000 [00:07<06:48,  4.80it/s]Perplexity: 5.7721:   2%|▏         | 36/2000 [00:07<06:48,  4.80it/s]Perplexity: 5.7721:   2%|▏         | 37/2000 [00:07<07:02,  4.65it/s]Perplexity: 5.7034:   2%|▏         | 37/2000 [00:08<07:02,  4.65it/s]Perplexity: 5.7034:   2%|▏         | 38/2000 [00:08<07:09,  4.57it/s]Perplexity: 5.6203:   2%|▏         | 38/2000 [00:08<07:09,  4.57it/s]Perplexity: 5.6203:   2%|▏         | 39/2000 [00:08<07:07,  4.59it/s]Perplexity: 5.5712:   2%|▏         | 39/2000 [00:08<07:07,  4.59it/s]Perplexity: 5.5712:   2%|▏         | 40/2000 [00:08<07:00,  4.66it/s]Perplexity: 5.5612:   2%|▏         | 40/2000 [00:08<07:00,  4.66it/s]Perplexity: 5.5612:   2%|▏         | 41/2000 [00:08<06:49,  4.78it/s]Perplexity: 5.5322:   2%|▏         | 41/2000 [00:08<06:49,  4.78it/s]Perplexity: 5.5322:   2%|▏         | 42/2000 [00:08<06:42,  4.86it/s]Perplexity: 5.5162:   2%|▏         | 42/2000 [00:09<06:42,  4.86it/s]Perplexity: 5.5162:   2%|▏         | 43/2000 [00:09<06:45,  4.83it/s]Perplexity: 5.5856:   2%|▏         | 43/2000 [00:09<06:45,  4.83it/s]Perplexity: 5.5856:   2%|▏         | 44/2000 [00:09<06:46,  4.81it/s]Perplexity: 5.6159:   2%|▏         | 44/2000 [00:09<06:46,  4.81it/s]Perplexity: 5.6159:   2%|▏         | 45/2000 [00:09<06:51,  4.75it/s]Perplexity: 5.6330:   2%|▏         | 45/2000 [00:09<06:51,  4.75it/s]Perplexity: 5.6330:   2%|▏         | 46/2000 [00:09<06:48,  4.78it/s]Perplexity: 5.7039:   2%|▏         | 46/2000 [00:09<06:48,  4.78it/s]Perplexity: 5.7039:   2%|▏         | 47/2000 [00:09<06:11,  5.25it/s]Perplexity: 5.7450:   2%|▏         | 47/2000 [00:10<06:11,  5.25it/s]Perplexity: 5.7450:   2%|▏         | 48/2000 [00:10<06:16,  5.18it/s]Perplexity: 5.7542:   2%|▏         | 48/2000 [00:10<06:16,  5.18it/s]Perplexity: 5.7542:   2%|▏         | 49/2000 [00:10<06:21,  5.12it/s]Perplexity: 5.7673:   2%|▏         | 49/2000 [00:10<06:21,  5.12it/s]Perplexity: 5.7673:   2%|▎         | 50/2000 [00:10<06:24,  5.07it/s]Perplexity: 5.7795:   2%|▎         | 50/2000 [00:10<06:24,  5.07it/s]Perplexity: 5.7795:   3%|▎         | 51/2000 [00:10<06:30,  4.99it/s]Perplexity: 5.8622:   3%|▎         | 51/2000 [00:10<06:30,  4.99it/s]Perplexity: 5.8622:   3%|▎         | 52/2000 [00:10<06:33,  4.95it/s]Perplexity: 5.8099:   3%|▎         | 52/2000 [00:11<06:33,  4.95it/s]Perplexity: 5.8099:   3%|▎         | 53/2000 [00:11<06:38,  4.88it/s]Perplexity: 5.7734:   3%|▎         | 53/2000 [00:11<06:38,  4.88it/s]Perplexity: 5.7734:   3%|▎         | 54/2000 [00:11<06:46,  4.79it/s]Perplexity: 5.7652:   3%|▎         | 54/2000 [00:11<06:46,  4.79it/s]Perplexity: 5.7652:   3%|▎         | 55/2000 [00:11<06:41,  4.84it/s]Perplexity: 5.7898:   3%|▎         | 55/2000 [00:11<06:41,  4.84it/s]Perplexity: 5.7898:   3%|▎         | 56/2000 [00:11<05:58,  5.43it/s]Perplexity: 5.7361:   3%|▎         | 56/2000 [00:11<05:58,  5.43it/s]Perplexity: 5.7361:   3%|▎         | 57/2000 [00:11<06:23,  5.07it/s]Perplexity: 5.7245:   3%|▎         | 57/2000 [00:12<06:23,  5.07it/s]Perplexity: 5.7245:   3%|▎         | 58/2000 [00:12<06:34,  4.92it/s]Perplexity: 5.7585:   3%|▎         | 58/2000 [00:12<06:34,  4.92it/s]Perplexity: 5.7585:   3%|▎         | 59/2000 [00:12<06:37,  4.88it/s]Perplexity: 5.7965:   3%|▎         | 59/2000 [00:12<06:37,  4.88it/s]Perplexity: 5.7965:   3%|▎         | 60/2000 [00:12<06:36,  4.89it/s]Perplexity: 5.7753:   3%|▎         | 60/2000 [00:12<06:36,  4.89it/s]Perplexity: 5.7753:   3%|▎         | 61/2000 [00:12<06:58,  4.64it/s]Perplexity: 5.7651:   3%|▎         | 61/2000 [00:12<06:58,  4.64it/s]Perplexity: 5.7651:   3%|▎         | 62/2000 [00:12<06:55,  4.67it/s]Perplexity: 5.7912:   3%|▎         | 62/2000 [00:13<06:55,  4.67it/s]Perplexity: 5.7912:   3%|▎         | 63/2000 [00:13<06:47,  4.75it/s]Perplexity: 5.7771:   3%|▎         | 63/2000 [00:13<06:47,  4.75it/s]Perplexity: 5.7771:   3%|▎         | 64/2000 [00:13<06:49,  4.73it/s]Perplexity: 5.8000:   3%|▎         | 64/2000 [00:13<06:49,  4.73it/s]Perplexity: 5.8000:   3%|▎         | 65/2000 [00:13<06:42,  4.81it/s]Perplexity: 5.7705:   3%|▎         | 65/2000 [00:13<06:42,  4.81it/s]Perplexity: 5.7705:   3%|▎         | 66/2000 [00:13<06:45,  4.77it/s]Perplexity: 5.8211:   3%|▎         | 66/2000 [00:13<06:45,  4.77it/s]Perplexity: 5.8211:   3%|▎         | 67/2000 [00:13<06:43,  4.79it/s]Perplexity: 5.8730:   3%|▎         | 67/2000 [00:14<06:43,  4.79it/s]Perplexity: 5.8730:   3%|▎         | 68/2000 [00:14<06:38,  4.85it/s]Perplexity: 5.8630:   3%|▎         | 68/2000 [00:14<06:38,  4.85it/s]Perplexity: 5.8630:   3%|▎         | 69/2000 [00:14<06:34,  4.89it/s]Perplexity: 5.8478:   3%|▎         | 69/2000 [00:14<06:34,  4.89it/s]Perplexity: 5.8478:   4%|▎         | 70/2000 [00:14<06:35,  4.88it/s]Perplexity: 5.8560:   4%|▎         | 70/2000 [00:14<06:35,  4.88it/s]Perplexity: 5.8560:   4%|▎         | 71/2000 [00:14<06:33,  4.90it/s]Perplexity: 5.9150:   4%|▎         | 71/2000 [00:14<06:33,  4.90it/s]Perplexity: 5.9150:   4%|▎         | 72/2000 [00:14<06:33,  4.90it/s]Perplexity: 5.9719:   4%|▎         | 72/2000 [00:15<06:33,  4.90it/s]Perplexity: 5.9719:   4%|▎         | 73/2000 [00:15<06:30,  4.93it/s]Perplexity: 5.8862:   4%|▎         | 73/2000 [00:15<06:30,  4.93it/s]Perplexity: 5.8862:   4%|▎         | 74/2000 [00:15<06:37,  4.84it/s]Perplexity: 5.9043:   4%|▎         | 74/2000 [00:15<06:37,  4.84it/s]Perplexity: 5.9043:   4%|▍         | 75/2000 [00:15<06:40,  4.80it/s]Perplexity: 5.9184:   4%|▍         | 75/2000 [00:15<06:40,  4.80it/s]Perplexity: 5.9184:   4%|▍         | 76/2000 [00:15<06:43,  4.77it/s]Perplexity: 5.9231:   4%|▍         | 76/2000 [00:15<06:43,  4.77it/s]Perplexity: 5.9277:   4%|▍         | 76/2000 [00:16<06:43,  4.77it/s]Perplexity: 5.9277:   4%|▍         | 78/2000 [00:16<05:39,  5.66it/s]Perplexity: 5.9081:   4%|▍         | 78/2000 [00:16<05:39,  5.66it/s]Perplexity: 5.9081:   4%|▍         | 79/2000 [00:16<06:08,  5.21it/s]Perplexity: 5.8744:   4%|▍         | 79/2000 [00:16<06:08,  5.21it/s]Perplexity: 5.8744:   4%|▍         | 80/2000 [00:16<06:24,  4.99it/s]Perplexity: 5.9063:   4%|▍         | 80/2000 [00:16<06:24,  4.99it/s]Perplexity: 5.9063:   4%|▍         | 81/2000 [00:16<06:25,  4.98it/s]Perplexity: 5.9053:   4%|▍         | 81/2000 [00:16<06:25,  4.98it/s]Perplexity: 5.9053:   4%|▍         | 82/2000 [00:16<06:25,  4.98it/s]Perplexity: 5.9308:   4%|▍         | 82/2000 [00:17<06:25,  4.98it/s]Perplexity: 5.9308:   4%|▍         | 83/2000 [00:17<06:27,  4.95it/s]Perplexity: 5.9055:   4%|▍         | 83/2000 [00:17<06:27,  4.95it/s]Perplexity: 5.9055:   4%|▍         | 84/2000 [00:17<06:26,  4.96it/s]Perplexity: 5.9347:   4%|▍         | 84/2000 [00:17<06:26,  4.96it/s]Perplexity: 5.9347:   4%|▍         | 85/2000 [00:17<06:26,  4.95it/s]Perplexity: 5.9417:   4%|▍         | 85/2000 [00:17<06:26,  4.95it/s]Perplexity: 5.9417:   4%|▍         | 86/2000 [00:17<05:58,  5.34it/s]Perplexity: 5.9238:   4%|▍         | 86/2000 [00:17<05:58,  5.34it/s]Perplexity: 5.9238:   4%|▍         | 87/2000 [00:17<06:11,  5.16it/s]Perplexity: 5.9725:   4%|▍         | 87/2000 [00:18<06:11,  5.16it/s]Perplexity: 5.9725:   4%|▍         | 88/2000 [00:18<06:16,  5.07it/s]Perplexity: 5.9801:   4%|▍         | 88/2000 [00:18<06:16,  5.07it/s]Perplexity: 5.9801:   4%|▍         | 89/2000 [00:18<06:33,  4.86it/s]Perplexity: 5.9955:   4%|▍         | 89/2000 [00:18<06:33,  4.86it/s]Perplexity: 5.9955:   4%|▍         | 90/2000 [00:18<06:30,  4.89it/s]Perplexity: 6.0162:   4%|▍         | 90/2000 [00:18<06:30,  4.89it/s]Perplexity: 6.0162:   5%|▍         | 91/2000 [00:18<06:31,  4.87it/s]Perplexity: 5.9571:   5%|▍         | 91/2000 [00:18<06:31,  4.87it/s]Perplexity: 5.9571:   5%|▍         | 92/2000 [00:18<06:45,  4.71it/s]Perplexity: 5.9804:   5%|▍         | 92/2000 [00:19<06:45,  4.71it/s]Perplexity: 5.9804:   5%|▍         | 93/2000 [00:19<06:37,  4.80it/s]Perplexity: 5.9804:   5%|▍         | 93/2000 [00:19<06:34,  4.83it/s]
Traceback (most recent call last):
  File "/mounts/u-amo-d1/grad/mha361/work/probless/Sentiment/main_llma_copy.py", line 115, in <module>
    b_ppl                     = evaluate_llma_language_modeling(model, wiki_sample, tokenizer, 2000)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mounts/u-amo-d1/grad/mha361/work/probless/Sentiment/utilities.py", line 1722, in evaluate_llma_language_modeling
    outputs = model(**inputs, labels=inputs["input_ids"])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/amo-d1/grad/mha361/anaconda3/envs/ml_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/amo-d1/grad/mha361/anaconda3/envs/ml_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mounts/u-amo-d1/grad/mha361/work/probless/Sentiment/models/lama.py", line 1231, in forward
    outputs = self.model(
              ^^^^^^^^^^^
  File "/u/amo-d1/grad/mha361/anaconda3/envs/ml_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/amo-d1/grad/mha361/anaconda3/envs/ml_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mounts/u-amo-d1/grad/mha361/work/probless/Sentiment/models/lama.py", line 978, in forward
    layer_outputs = decoder_layer(
                    ^^^^^^^^^^^^^^
  File "/u/amo-d1/grad/mha361/anaconda3/envs/ml_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/amo-d1/grad/mha361/anaconda3/envs/ml_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
